<!DOCTYPE html>
<html class="h-100">
<head>

    <title>Exhaust Timer Experiment</title>

    <!-- mobile meta tags-->
    <meta name="viewport" content="width=device-width"/>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!-- pwa manifest -->
    <link rel="manifest" href="manifest.json" crossorigin="use-credentials"/>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/widgets.css">
    <link rel="stylesheet" href="css/skin.css">

</head>
<body class="skin-body h-100" data-view-group="mode" data-view-states="">

  <section data-view-group="screens" data-view-states="main">
    
    <!-- # main screen -->
    <section data-view-group="screens" data-view-name="main">
    <div class="container-1rem">

      <!-- navigation -->
      <div class="d-flex justify-content-end">
        <div>
          <button class="skin-btn-default" data-onclick="navigate" data-target="settings">Settings</button>
          <div class="void void-1x"></div>
        </div>
      </div>

      <!-- # ratio slider -->
      <div>
        Work / rest ratio : 
        <span class="_txtWorkRestRatio"></span>
        <div>
          <input class="_inWorkRestRatio w-100" type="range" step="0.01" min="0.05" max="0.6" data-oninput="update-ratio"/>
        </div>
        <div class="_txtInfoRatioConfig d-flex gap-quarter flex-column">
          <div>
            Work duration: <span class="_Work"></span>
            <button class="skin-btn-default" data-onclick="set-limit">Edit</button>
          </div>
          <div>
            Break duration: <span class="_Break"></span>
            <button class="skin-btn-default obsoletes" data-onclick="set-break">Edit</button>
          </div>
        </div>
        <div class="void void-half"></div>
        <div class="d-flex justify-content-end">
          <button class="skin-btn-default" data-onclick="apply-ratio">Apply</button>
        </div>
      </div>
      <div class="void void-2x"></div>
      <hr/>
      <div class="void void-2x"></div>

      <!-- # instant recovery -->
      <div class="d-flex gap-half justify-content-end">
        <div>
          <button class="skin-btn-default" data-onclick="instant-recovery">Instant Recovery</button>
        </div>
        <button class="skin-btn-default" onclick="ui.RemindMe()">Fake screen off</button>
      </div>
      <div class="void void-2x"></div>

      <div class="wg-Time" style="text-align:center;">
        
        <div>
          <span class="inner">
            <span class="_txt time"></span>
            <span class="limit">/</span>
            <span class="limit _limit"></span>
          </span>
        </div>
        <div class="void void-full"></div>

        <div data-view-group="timerState" data-view-states="idle">
      
          <!-- # timer info -->
          <div>
            <span class="_txtTimer">---</span>
          </div>
          <div class="void void-full"></div>

          <!-- # timer actions -->
          <div data-view-group="timerState" data-view-name="idle started">
            <div class="d-flex gap-half flex-wrap justify-content-center align-items-center">
              <div data-view-group="timerState" data-view-name="idle">
                <button class="skin-btn-default" onclick="ui.Start()">Start</button>
              </div>
              <div data-view-group="timerState" data-view-name="started">
                <button class="skin-btn-danger" onclick="ui.Stop()">Pause</button>
              </div>
              |
              <div data-view-group="timerState" data-view-name="idle started">
                <div class="d-flex gap-half justify-content-center">
                  <button class="skin-btn-danger" onclick="ui.TakeRest()">Take a rest</button>
                  <button class="skin-btn-danger obsoletes" onclick="app.CustomRest()">Custom</button>
                </div>   
              </div>
            </div>
          </div>
          <div data-view-group="timerState" data-view-name="recovery">
            <button class="skin-btn-danger" onclick="ui.StopRest()">Stop</button>
          </div>
          <div class="void void-2x"></div>

          <!-- # rest time -->
          <div class="d-flex flex-column gap-half align-items-ccenter">
            <div>
              Rest time: <span class="_txtEstRestTime"></span>
            </div>
          </div>
          <div class="void void-1x"></div>

          <!-- # recovery, # restore -->
          <div data-view-group="timerState" data-view-name="recovery">
            <div>
              <small class="_txtRestoreTime"></small>
            </div>
          </div>

        </div>

      </div>
          
    </div>
    </section>

    <!-- # settings screen -->
    <section data-view-group="screens" data-view-name="settings">
    <div class="container-1rem">
      
      <!-- navigation -->
      <div>
        <div class="d-flex gap-full align-items-center">
          <button class="skin-btn-default" data-onclick="navigate" data-target="main">Back</button>
          <span>Settings</span>
        </div>
        <div class="void void-1x"></div>
      </div>


      <!-- PWA cache manager -->
      <div>
        <small>Updates & Offline Access</small>
      </div>
      <div class="void void-half"></div>
      <div style="display:flex;gap:0.5rem;flex-wrap:wrap;justify-content:center;">
        <button class="skin-btn-default" onclick="pwaCacher.Cache()">Check for updates</button>
        <button class="skin-btn-default" onclick="pwaCacher.ClearCache()">Remove app cache</button>
      </div>
      <hr/>
      <div class="void void-2x"></div>
    
      <div>
        <small>Application data</small>
      </div>
      <div class="void void-half"></div>
      <button class="skin-btn-default" data-onclick="reset-data">Reset data</button>
      <hr/>
      <div class="void void-2x"></div>

      <!-- # sound, # alarm -->
      <div class="settings-group">
        <div class="settings-group-title">Alarm Sound</div>
        <div class="void void-half"></div>
        <div class="settings-card-inner">
          
          <div class="d-flex flex-wrap gap-half">
            <button class="skin-btn-default" data-onclick="pick-audio">Set audio</button>
            <button class="skin-btn-default" data-onclick="remove-audio">Remove audio</button>
            <button class="skin-btn-default" data-onclick="test-audio">Test audio</button>
            <button class="skin-btn-default" data-onclick="stop-test-audio">Stop test</button>
          </div>
          <div class="void-half"></div>
          
          <div class="d-flex align-items-center gap-half">
            Volume : <input data-jsq="alarm-volume" type="range" min="0.2" max="1" step="0.1" value="1" data-oninput="handle-input-alarm-volume"/>
          </div>
          
        </div>
      </div>

    </div>
    </section>
    
  </section>

  <div class="container-screen-off _container-screen-off"></div>

  <!-- # templates -->
  <template id="tmp-dialog-alert">
    <dialog class="wg-Windog">
    <!-- ^# tmp-dialog-alert -->
      <div class="backdrop"></div>
      <div class="wrapper">
        
        <form method="dialog" data-ref="form">
          <div data-kind="message"></div>
          <div class="void void-full"></div>
          <div class="text-center">
            <button>Ok</button>
          </div>
        </form>
      </div>
    </dialog>
  </template>
  <template id="tmp-dialog-prompt">
    <dialog class="wg-Windog">
    <!-- ^# tmp-dialog-prompt -->
      <div class="backdrop"></div>
      <div class="wrapper">
        
        <form method="dialog" data-ref="form">
          <div data-kind="message"></div>
          <div class="void void-half"></div>
          
          <input class="input-style-default" type="text" data-kind="input"/>
          <div class="void void-full"></div>
          
          <div class="d-flex justify-content-end gap-full">
            <button value="ok">Ok</button>
            <button>Cancel</button>
          </div>
        </form>
      </div>
    </dialog>
  </template>
  <template id="tmp-dialog-confirm">
    <dialog class="wg-Windog">
    <!-- ^# tmp-dialog-confirm -->
      <div class="backdrop"></div>
      <div class="wrapper">
      
        <form method="dialog" data-ref="form">
          <div data-kind="message"></div>
          <div class="void void-full"></div>
          <div class="d-flex justify-content-end gap-full">
            <button value="ok">OK</button>
            <button>Cancel</button>
          </div>
        </form>
      </div>
    </dialog>
  </template>

  <script src="pwa-cacher.js"></script>
  <script src="index.js" type="module"></script>

    <script>
      if (typeof(navigator) !== 'undefined' && 'serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js').then(function(swo) {
            // success
        }).catch(function(e) {
            console.error('Something went wrong.')
        });
      }
    </script>
  
</body>
</html>